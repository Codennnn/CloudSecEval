# 异步提供者

在某些场景中，应用在启动前可能需要完成一些**异步操作**，比如等待数据库连接建立成功，才能开始处理外部请求。此时，可以使用**异步提供者**（Async Provider）来实现这一流程控制。

实现方式通常基于 `useFactory` 配置，并结合 `async/await` 使用。通过让工厂函数返回一个 `Promise`，Nest 会在注入该提供者之前，自动等待异步任务完成并使用其结果进行依赖注入。

```ts
{
  provide: 'ASYNC_CONNECTION',
  useFactory: async () => {
    const connection = await createConnection(options);
    return connection;
  },
}
```

<CalloutInfo>
  你可以在[自定义提供者](/fundamentals/custom-providers)章节中查看更多相关用法。
</CalloutInfo>

## 提供者注入

异步提供者的注入方式与普通提供者一致，都是通过注入令牌进行识别与绑定。在上面的示例中，可以使用 `@Inject('ASYNC_CONNECTION')` 将其注入到其他类中：

```ts
@Injectable()
export class SomeService {
  constructor(@Inject('ASYNC_CONNECTION') private connection: Connection) {}
}
```

## 进阶示例

在 [TypeORM 实践](/recipes/sql-typeorm)一节中，你可以找到更完整的异步提供者配置与使用案例，适用于真实项目中的数据库连接管理。
