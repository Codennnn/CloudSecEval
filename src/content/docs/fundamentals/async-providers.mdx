# 异步提供者

在某些场景下，应用启动前需要等待一个或多个**异步任务**完成。例如，可能希望在与数据库建立连接之前，不开始接收请求。此时，可以借助异步提供者（Async Provider）来满足这一需求。

具体实现通常结合 `useFactory` 语法和 `async/await`，使工厂函数返回一个 `Promise`，并在函数内部通过 `await` 等待异步操作完成。Nest 会在实例化依赖注入该提供者的任何类之前，自动等待该 Promise 完成并返回结果。

```ts
{
  provide: 'ASYNC_CONNECTION',
  useFactory: async () => {
    const connection = await createConnection(options);
    return connection;
  },
}
```

<CalloutInfo>
  你可以在[这里](/fundamentals/custom-providers)了解更多关于自定义提供者的用法。
</CalloutInfo>

## 注入方式

异步提供者和普通提供者一样，通过注入令牌（Injection Token）注入到其他组件。在上例中，可以使用 `@Inject('ASYNC_CONNECTION')` 进行注入。

## 示例

在 [TypeORM 实践](/recipes/sql-typeorm)中，有更完整的异步提供者示例供参考。
