# 概述

[Nest 命令行工具（Nest CLI）](https://github.com/nestjs/nest-cli) 是一个命令行界面工具，可以帮助你初始化、开发和维护 Nest 应用。它提供了丰富的功能，包括搭建项目脚手架、在开发模式下启动服务，以及为生产环境构建和打包应用。Nest CLI 融合了最佳架构实践，旨在鼓励开发者构建结构优良的应用。

## 安装

**注意**：本指南以 [npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm) 为例来安装依赖包（包括 Nest CLI）。你可以根据偏好选择其他包管理器。通过 npm 安装时，有多种方式可以确保操作系统能正确找到 `nest` CLI 的可执行文件。本文介绍一种便捷的方式：使用 `-g` 选项进行全局安装，这也是本指南默认采用的方式。

然而，全局安装方式需要注意两点：第一，你需要自行确保所安装包版本的正确性；第二，所有项目都将共享同一个版本的 CLI。

一个更稳妥的替代方案是使用 [npx](https://github.com/npm/cli/blob/latest/docs/lib/content/commands/npx.md) 工具（已内置于 npm CLI，其他包管理器也有类似功能），它可以确保你运行的是**版本可控**的 Nest CLI。更多信息，请查阅 [npx 文档](https://github.com/npm/cli/blob/latest/docs/lib/content/commands/npx.md)或咨询你的 DevOps 团队。

使用如下命令将 CLI 全局安装（关于全局安装的详细说明见上文“注意”部分）：

```bash
$ npm install -g @nestjs/cli
```

<CalloutInfo>
  <div>你也可以使用 `npx @nestjs/cli@latest` 命令，无需全局安装 CLI。</div>
</CalloutInfo>

## 基本工作流程

安装完成后，你就可以在命令行中直接使用 `nest` 命令了。输入以下命令，可以查看所有可用的 `nest` 命令：

```bash
$ nest --help
```

要获取特定命令的帮助信息，请使用以下格式。例如，将下方的 `generate` 替换为 `new` 或 `add`，就能查看对应命令的详细帮助：

```bash
$ nest generate --help
```

要创建一个新的 Nest 项目并在开发模式下运行，请先进入你希望存放项目的目录，然后执行以下命令：

```bash
$ nest new my-nest-project
$ cd my-nest-project
$ npm run start:dev
```

在浏览器中打开 [http://localhost:3000](http://localhost:3000)，就能看到新应用已经成功运行。此后，每当你修改源文件，应用都会自动重新编译并完成热重载。

<CalloutInfo>
  推荐使用 [SWC 构建器](/recipes/swc) 以获得更快的构建速度（比默认 TypeScript
  编译器快 10 倍）。
</CalloutInfo>

## 项目结构

当你运行 `nest new` 时，Nest 会创建一个新文件夹并生成一套初始文件，从而构建出一套标准的项目结构。你可以在这个默认结构的基础上继续开发，按照本指南的说明添加新组件。我们称这种由 `nest new` 生成的项目结构为**标准模式**。此外，Nest 还支持另一种管理多个项目和库的结构，即**多包仓库（Monorepo）模式**。

标准模式和多包仓库模式在大部分 Nest 特性上是相通的，本指南的内容也对两者同样适用。他们的主要区别在于**构建流程**和对[库](/cli/libraries)的内置支持。（多包仓库模式的优势在于，它能简化管理多个项目时所产生的复杂构建流程。）

此外，你可以随时从标准模式切换到多包仓库模式。因此，在学习 Nest 的初期，你暂时不必纠结于模式的选择。

你可以使用任意一种模式来管理多个项目。以下是两种模式的主要区别简要对比：

| 功能                                             | 标准模式                  | 多包仓库模式                 |
| ------------------------------------------------ | ------------------------- | ---------------------------- |
| 多项目管理                                       | 独立的项目结构            | 单一仓库（Monorepo）         |
| `node_modules` & `package.json`                  | 各自独立                  | 在仓库中共享                 |
| 默认编译器                                       | `tsc`                     | webpack                      |
| 编译器设置                                       | 分别指定                  | 仓库级默认，可按项目覆盖     |
| 配置文件如 `eslint.config.mjs`、`.prettierrc` 等 | 分别指定                  | 在仓库中共享                 |
| `nest build` 和 `nest start` 命令                | 针对当前项目              | 默认针对仓库中的**默认项目** |
| 库（Library）                                    | 手动管理（如通过 npm 包） | 内置支持（路径映射、打包等） |

如果想进一步了解两种模式的差异以便做出选择，请阅读[工作空间](/cli/monorepo)和[库](/cli/libraries)章节获取更详细的信息。

## CLI 命令语法

所有 `nest` 命令都遵循相同的格式：

```bash
nest commandOrAlias requiredArg [optionalArg] [options]
```

例如：

```bash
$ nest new my-nest-project --dry-run
```

此处的 `new` 就是 _commandOrAlias_（即命令或其别名）。`new` 命令的别名是 `n`。`my-nest-project` 是 _requiredArg_（必需参数）。如果你未在命令行中提供该参数，`nest` 会提示你输入。`--dry-run` 是一个选项（option），它也有一个简写形式 `-d`。因此，以下命令与上面等价：

```bash
$ nest n my-nest-project -d
```

大多数命令和部分选项都支持别名。你可以运行 `nest new --help` 来查看所有可用的选项和别名，从而更好地理解上述命令结构。

## 命令总览

运行 `nest <command> --help` 可查看每个命令的专属选项。更详细的说明请参见[用法](/cli/usages)章节。

| 命令       | 别名 | 描述                                             |
| ---------- | ---- | ------------------------------------------------ |
| `new`      | `n`  | 创建一个新的标准模式 Nest 应用。                 |
| `generate` | `g`  | 基于原理图（Schematics）生成或修改文件。         |
| `build`    |      | 将应用或工作空间编译到输出目录。                 |
| `start`    |      | 编译并运行应用（在工作空间中，则针对默认项目）。 |
| `add`      |      | 导入一个已打包的 nest 库，并运行其安装原理图。   |
| `info`     | `i`  | 显示已安装的 Nest 相关包及其他有用的系统信息。   |

## 环境要求

Nest 命令行工具（Nest CLI）依赖 Node.js 的[国际化（ICU）](https://nodejs.org/api/intl.html)支持。建议从 [Node.js 官网](https://nodejs.org/en/download)下载并安装官方二进制文件。如果你遇到 ICU 相关错误，请检查所用 Node.js 是否满足此要求。

```bash
node -p process.versions.icu
```

如果该命令输出 `undefined`，则说明你的 Node.js 未包含国际化支持。
