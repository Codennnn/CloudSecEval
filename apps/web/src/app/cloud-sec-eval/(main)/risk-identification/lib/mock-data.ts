import { type RiskItem, RiskLevel, type RiskStats, RiskStatus, RiskType } from './types'

/**
 * 生成模拟风险数据
 */
export const mockRisks: RiskItem[] = [
  {
    id: 'risk-001',
    name: 'MySQL 数据库弱口令',
    level: RiskLevel.HIGH,
    type: RiskType.WEAK_PASSWORD,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Nessus',
    affectedAssets: ['192.168.1.100:3306', '192.168.1.101:3306'],
    description: '检测到 MySQL 数据库使用弱口令（root/123456），存在被暴力破解的风险。攻击者可能通过弱口令获取数据库访问权限，导致敏感数据泄露。',
    attackPath: ['外网入口', 'Web服务器', 'MySQL数据库', '敏感数据'],
    remediation: '1. 立即修改为强密码（至少12位，包含大小写字母、数字和特殊字符）\n2. 启用密码复杂度策略\n3. 限制远程访问，仅允许特定IP访问\n4. 启用双因素认证',
    discoveredAt: '2025-10-27 14:30:00',
    updatedAt: '2025-10-27 14:30:00',
    cvssScore: 9.1,
  },
  {
    id: 'risk-002',
    name: 'Web应用存在SQL注入漏洞',
    level: RiskLevel.HIGH,
    type: RiskType.SQL_INJECTION,
    status: RiskStatus.PROCESSING,
    source: '人工渗透测试',
    affectedAssets: ['https://app.example.com/login', 'https://app.example.com/search'],
    description: '在登录页面和搜索功能中发现SQL注入漏洞，攻击者可通过构造恶意SQL语句获取数据库敏感信息。',
    attackPath: ['Web应用', '数据库查询', '数据库服务器', '敏感数据'],
    remediation: '1. 使用参数化查询或预编译语句\n2. 对用户输入进行严格过滤和转义\n3. 实施最小权限原则\n4. 部署Web应用防火墙（WAF）',
    discoveredAt: '2025-10-26 10:15:00',
    updatedAt: '2025-10-27 09:20:00',
    notes: '开发团队已开始修复，预计2天内完成',
    cvssScore: 8.8,
  },
  {
    id: 'risk-003',
    name: 'Apache服务器版本过期',
    level: RiskLevel.MEDIUM,
    type: RiskType.OUTDATED_SOFTWARE,
    status: RiskStatus.PENDING,
    source: '自动扫描 - OpenVAS',
    affectedAssets: ['192.168.1.50:80', '192.168.1.51:80', '192.168.1.52:80'],
    description: '检测到Apache HTTP Server版本为2.4.29，存在多个已知安全漏洞（CVE-2021-44790, CVE-2021-44224）。',
    remediation: '1. 升级Apache至最新稳定版本（2.4.54+）\n2. 应用所有安全补丁\n3. 配置自动更新策略\n4. 定期检查软件版本',
    discoveredAt: '2025-10-25 16:45:00',
    updatedAt: '2025-10-25 16:45:00',
    cvssScore: 6.5,
  },
  {
    id: 'risk-004',
    name: 'Redis未授权访问',
    level: RiskLevel.HIGH,
    type: RiskType.UNAUTHORIZED_ACCESS,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Nmap',
    affectedAssets: ['192.168.1.200:6379'],
    description: 'Redis服务未设置密码认证，且绑定在0.0.0.0，允许任何人无需认证即可访问。',
    attackPath: ['外网入口', 'Redis服务', '缓存数据', '会话劫持'],
    remediation: '1. 设置强密码（requirepass）\n2. 修改绑定地址为127.0.0.1或内网IP\n3. 配置防火墙规则限制访问\n4. 禁用危险命令（FLUSHALL, CONFIG等）',
    discoveredAt: '2025-10-27 11:00:00',
    updatedAt: '2025-10-27 11:00:00',
    cvssScore: 9.3,
  },
  {
    id: 'risk-005',
    name: 'XSS跨站脚本漏洞',
    level: RiskLevel.MEDIUM,
    type: RiskType.XSS,
    status: RiskStatus.RESOLVED,
    source: '人工渗透测试',
    affectedAssets: ['https://app.example.com/comment'],
    description: '评论功能未对用户输入进行HTML转义，存在存储型XSS漏洞。',
    remediation: '1. 对所有用户输入进行HTML实体编码\n2. 实施内容安全策略（CSP）\n3. 使用HTTPOnly标志保护Cookie\n4. 定期进行安全代码审查',
    discoveredAt: '2025-10-24 14:20:00',
    updatedAt: '2025-10-26 18:30:00',
    notes: '已修复并通过复测',
    cvssScore: 6.1,
  },
  {
    id: 'risk-006',
    name: 'SSH服务允许root登录',
    level: RiskLevel.MEDIUM,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '配置审计',
    affectedAssets: ['192.168.1.10:22', '192.168.1.11:22', '192.168.1.12:22', '192.168.1.13:22'],
    description: 'SSH配置文件中PermitRootLogin设置为yes，允许root用户直接登录，增加被攻击风险。',
    remediation: '1. 修改/etc/ssh/sshd_config，设置PermitRootLogin为no\n2. 创建普通用户并配置sudo权限\n3. 使用密钥认证替代密码认证\n4. 修改默认SSH端口',
    discoveredAt: '2025-10-25 09:30:00',
    updatedAt: '2025-10-25 09:30:00',
    cvssScore: 5.8,
  },
  {
    id: 'risk-007',
    name: 'API接口未实施速率限制',
    level: RiskLevel.MEDIUM,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PROCESSING,
    source: '安全审计',
    affectedAssets: ['https://api.example.com/v1/*'],
    description: 'API接口未实施速率限制，可能遭受暴力破解或DDoS攻击。',
    remediation: '1. 实施API速率限制（如每分钟100次请求）\n2. 使用令牌桶或滑动窗口算法\n3. 对异常流量进行监控和告警\n4. 实施IP黑名单机制',
    discoveredAt: '2025-10-26 15:10:00',
    updatedAt: '2025-10-27 10:00:00',
    cvssScore: 5.3,
  },
  {
    id: 'risk-008',
    name: 'MongoDB数据库未加密传输',
    level: RiskLevel.MEDIUM,
    type: RiskType.DATA_LEAK,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Nessus',
    affectedAssets: ['192.168.1.150:27017'],
    description: 'MongoDB数据库未启用TLS/SSL加密，数据在网络传输过程中可能被窃听。',
    remediation: '1. 启用TLS/SSL加密传输\n2. 配置有效的SSL证书\n3. 强制客户端使用加密连接\n4. 定期更新证书',
    discoveredAt: '2025-10-25 13:20:00',
    updatedAt: '2025-10-25 13:20:00',
    cvssScore: 6.8,
  },
  {
    id: 'risk-009',
    name: 'Docker容器以root权限运行',
    level: RiskLevel.MEDIUM,
    type: RiskType.PRIVILEGE_ESCALATION,
    status: RiskStatus.PENDING,
    source: '容器安全扫描',
    affectedAssets: ['container-web-01', 'container-api-02', 'container-worker-03'],
    description: '多个Docker容器以root用户运行，存在权限提升风险。',
    remediation: '1. 创建非特权用户运行容器\n2. 在Dockerfile中使用USER指令\n3. 实施最小权限原则\n4. 使用安全上下文约束（Security Context）',
    discoveredAt: '2025-10-26 11:40:00',
    updatedAt: '2025-10-26 11:40:00',
    cvssScore: 6.2,
  },
  {
    id: 'risk-010',
    name: 'Nginx配置文件暴露敏感信息',
    level: RiskLevel.LOW,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.RESOLVED,
    source: '配置审计',
    affectedAssets: ['192.168.1.30:80'],
    description: 'Nginx配置文件中包含数据库连接字符串等敏感信息，且文件权限设置不当。',
    remediation: '1. 移除配置文件中的敏感信息\n2. 使用环境变量或密钥管理服务\n3. 设置正确的文件权限（600或640）\n4. 定期审计配置文件',
    discoveredAt: '2025-10-24 10:00:00',
    updatedAt: '2025-10-25 16:00:00',
    notes: '已移除敏感信息并修改权限',
    cvssScore: 3.7,
  },
  {
    id: 'risk-011',
    name: 'Jenkins未启用CSRF保护',
    level: RiskLevel.MEDIUM,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Burp Suite',
    affectedAssets: ['https://jenkins.example.com'],
    description: 'Jenkins CI/CD平台未启用CSRF保护，攻击者可能通过CSRF攻击执行恶意操作。',
    remediation: '1. 启用CSRF保护（默认应启用）\n2. 检查Jenkins版本并升级至最新版\n3. 配置安全域和授权策略\n4. 限制匿名用户权限',
    discoveredAt: '2025-10-27 08:15:00',
    updatedAt: '2025-10-27 08:15:00',
    cvssScore: 6.5,
  },
  {
    id: 'risk-012',
    name: 'FTP服务使用明文传输',
    level: RiskLevel.HIGH,
    type: RiskType.DATA_LEAK,
    status: RiskStatus.PENDING,
    source: '网络流量分析',
    affectedAssets: ['192.168.1.80:21'],
    description: 'FTP服务使用明文传输，用户名、密码和文件内容可能被窃听。',
    attackPath: ['网络嗅探', 'FTP流量', '凭证窃取', '文件泄露'],
    remediation: '1. 使用SFTP或FTPS替代FTP\n2. 禁用明文FTP服务\n3. 实施网络隔离\n4. 使用VPN加密传输',
    discoveredAt: '2025-10-26 14:50:00',
    updatedAt: '2025-10-26 14:50:00',
    cvssScore: 7.5,
  },
  {
    id: 'risk-013',
    name: 'WordPress插件存在已知漏洞',
    level: RiskLevel.HIGH,
    type: RiskType.OUTDATED_SOFTWARE,
    status: RiskStatus.PROCESSING,
    source: '自动扫描 - WPScan',
    affectedAssets: ['https://blog.example.com'],
    description: 'WordPress插件"Contact Form 7"版本过期，存在文件上传漏洞（CVE-2020-35489）。',
    remediation: '1. 立即更新插件至最新版本\n2. 删除未使用的插件\n3. 定期检查插件更新\n4. 使用安全插件进行防护',
    discoveredAt: '2025-10-27 12:30:00',
    updatedAt: '2025-10-27 13:00:00',
    notes: '已通知运维团队处理',
    cvssScore: 8.1,
  },
  {
    id: 'risk-014',
    name: 'Elasticsearch集群未设置认证',
    level: RiskLevel.HIGH,
    type: RiskType.UNAUTHORIZED_ACCESS,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Shodan',
    affectedAssets: ['192.168.1.180:9200', '192.168.1.181:9200'],
    description: 'Elasticsearch集群未启用X-Pack安全功能，任何人都可以访问和操作数据。',
    attackPath: ['外网扫描', 'Elasticsearch API', '数据读取', '数据删除'],
    remediation: '1. 启用X-Pack Security\n2. 配置用户认证和角色权限\n3. 启用TLS加密\n4. 限制网络访问',
    discoveredAt: '2025-10-27 09:45:00',
    updatedAt: '2025-10-27 09:45:00',
    cvssScore: 9.1,
  },
  {
    id: 'risk-015',
    name: 'Java应用使用过期的Log4j版本',
    level: RiskLevel.HIGH,
    type: RiskType.OUTDATED_SOFTWARE,
    status: RiskStatus.RESOLVED,
    source: '依赖扫描 - OWASP Dependency Check',
    affectedAssets: ['app-server-01.jar', 'app-server-02.jar'],
    description: '应用使用Log4j 2.14.1版本，存在严重的远程代码执行漏洞（Log4Shell CVE-2021-44228）。',
    attackPath: ['恶意JNDI请求', 'Log4j解析', '远程代码执行', '服务器控制'],
    remediation: '1. 立即升级Log4j至2.17.1或更高版本\n2. 如无法升级，设置log4j2.formatMsgNoLookups=true\n3. 移除JndiLookup类\n4. 部署WAF规则拦截攻击',
    discoveredAt: '2025-10-23 10:00:00',
    updatedAt: '2025-10-24 20:00:00',
    notes: '紧急修复已完成，所有服务器已更新',
    cvssScore: 10.0,
  },
]

/**
 * 生成更多模拟数据（补充到30条）
 */
const additionalRisks: RiskItem[] = [
  {
    id: 'risk-016',
    name: 'Tomcat管理后台弱口令',
    level: RiskLevel.HIGH,
    type: RiskType.WEAK_PASSWORD,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Hydra',
    affectedAssets: ['192.168.1.120:8080'],
    description: 'Tomcat管理后台使用默认凭证（admin/admin），存在被入侵风险。',
    remediation: '1. 修改为强密码\n2. 限制管理后台访问IP\n3. 考虑禁用管理后台\n4. 启用访问日志审计',
    discoveredAt: '2025-10-27 07:20:00',
    updatedAt: '2025-10-27 07:20:00',
    cvssScore: 8.8,
  },
  {
    id: 'risk-017',
    name: 'CORS配置过于宽松',
    level: RiskLevel.MEDIUM,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '安全审计',
    affectedAssets: ['https://api.example.com'],
    description: 'API配置了Access-Control-Allow-Origin: *，允许任何域名跨域访问。',
    remediation: '1. 限制允许的域名列表\n2. 避免使用通配符*\n3. 验证Origin头\n4. 实施CSRF令牌',
    discoveredAt: '2025-10-26 16:30:00',
    updatedAt: '2025-10-26 16:30:00',
    cvssScore: 5.3,
  },
  {
    id: 'risk-018',
    name: 'Git仓库暴露在公网',
    level: RiskLevel.HIGH,
    type: RiskType.DATA_LEAK,
    status: RiskStatus.PROCESSING,
    source: '人工发现',
    affectedAssets: ['https://example.com/.git/'],
    description: '网站根目录下的.git文件夹可被公开访问，可能泄露源代码和敏感信息。',
    remediation: '1. 删除或移动.git目录\n2. 配置Web服务器禁止访问隐藏文件\n3. 检查是否有其他敏感文件暴露\n4. 审查代码中的硬编码凭证',
    discoveredAt: '2025-10-27 15:00:00',
    updatedAt: '2025-10-27 15:30:00',
    notes: '正在清理.git目录',
    cvssScore: 7.5,
  },
  {
    id: 'risk-019',
    name: 'SSL证书即将过期',
    level: RiskLevel.LOW,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '证书监控',
    affectedAssets: ['https://www.example.com', 'https://api.example.com'],
    description: 'SSL证书将在15天后过期，可能导致服务中断和安全警告。',
    remediation: '1. 续订SSL证书\n2. 配置自动续订（如Let\'s Encrypt）\n3. 设置证书过期提醒\n4. 测试新证书部署',
    discoveredAt: '2025-10-27 06:00:00',
    updatedAt: '2025-10-27 06:00:00',
    cvssScore: 3.1,
  },
  {
    id: 'risk-020',
    name: 'Kubernetes Dashboard未启用认证',
    level: RiskLevel.HIGH,
    type: RiskType.UNAUTHORIZED_ACCESS,
    status: RiskStatus.PENDING,
    source: '容器安全扫描',
    affectedAssets: ['https://k8s-dashboard.example.com'],
    description: 'Kubernetes Dashboard配置为匿名访问，任何人都可以管理集群资源。',
    attackPath: ['Dashboard访问', '集群管理', '容器控制', '数据窃取'],
    remediation: '1. 启用RBAC认证\n2. 配置ServiceAccount权限\n3. 使用kubectl proxy访问\n4. 限制网络访问',
    discoveredAt: '2025-10-27 10:30:00',
    updatedAt: '2025-10-27 10:30:00',
    cvssScore: 9.8,
  },
  {
    id: 'risk-021',
    name: 'PostgreSQL数据库日志记录不足',
    level: RiskLevel.LOW,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '配置审计',
    affectedAssets: ['192.168.1.110:5432'],
    description: 'PostgreSQL未启用详细日志记录，难以追踪安全事件和异常操作。',
    remediation: '1. 启用日志记录（logging_collector = on）\n2. 配置日志级别和内容\n3. 设置日志轮转策略\n4. 定期审查日志',
    discoveredAt: '2025-10-25 11:00:00',
    updatedAt: '2025-10-25 11:00:00',
    cvssScore: 2.7,
  },
  {
    id: 'risk-022',
    name: 'Windows Server未安装安全补丁',
    level: RiskLevel.HIGH,
    type: RiskType.OUTDATED_SOFTWARE,
    status: RiskStatus.PROCESSING,
    source: '补丁管理系统',
    affectedAssets: ['WIN-SRV-01', 'WIN-SRV-02', 'WIN-SRV-03'],
    description: 'Windows Server缺少关键安全补丁，存在多个已知漏洞（包括EternalBlue）。',
    remediation: '1. 立即安装所有安全补丁\n2. 启用Windows Update自动更新\n3. 定期检查补丁状态\n4. 测试补丁兼容性',
    discoveredAt: '2025-10-26 08:00:00',
    updatedAt: '2025-10-27 09:00:00',
    notes: '补丁安装计划已制定，将在维护窗口执行',
    cvssScore: 8.1,
  },
  {
    id: 'risk-023',
    name: 'SMTP服务器开放中继',
    level: RiskLevel.MEDIUM,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Nmap',
    affectedAssets: ['192.168.1.25:25'],
    description: 'SMTP服务器配置为开放中继，可能被滥用发送垃圾邮件。',
    remediation: '1. 禁用开放中继\n2. 配置SMTP认证\n3. 限制允许的发件人\n4. 实施SPF和DKIM',
    discoveredAt: '2025-10-26 13:15:00',
    updatedAt: '2025-10-26 13:15:00',
    cvssScore: 5.8,
  },
  {
    id: 'risk-024',
    name: 'AWS S3存储桶公开访问',
    level: RiskLevel.HIGH,
    type: RiskType.DATA_LEAK,
    status: RiskStatus.RESOLVED,
    source: '云安全扫描',
    affectedAssets: ['s3://company-backup', 's3://company-logs'],
    description: 'S3存储桶配置为公开读取，包含敏感的备份文件和日志数据。',
    attackPath: ['公开S3桶', '数据下载', '敏感信息泄露'],
    remediation: '1. 移除公开访问权限\n2. 启用存储桶策略\n3. 使用IAM角色控制访问\n4. 启用访问日志',
    discoveredAt: '2025-10-26 17:00:00',
    updatedAt: '2025-10-27 08:00:00',
    notes: '已修改权限，仅允许授权用户访问',
    cvssScore: 7.5,
  },
  {
    id: 'risk-025',
    name: 'PHP应用文件包含漏洞',
    level: RiskLevel.HIGH,
    type: RiskType.UNAUTHORIZED_ACCESS,
    status: RiskStatus.PENDING,
    source: '代码审计',
    affectedAssets: ['https://legacy.example.com/index.php'],
    description: 'PHP应用存在本地文件包含（LFI）漏洞，攻击者可读取服务器敏感文件。',
    attackPath: ['文件包含', '敏感文件读取', '配置泄露', '权限提升'],
    remediation: '1. 验证和过滤用户输入\n2. 使用白名单限制可包含文件\n3. 禁用危险PHP函数\n4. 升级到安全的框架',
    discoveredAt: '2025-10-27 13:45:00',
    updatedAt: '2025-10-27 13:45:00',
    cvssScore: 8.6,
  },
  {
    id: 'risk-026',
    name: 'VPN服务使用弱加密算法',
    level: RiskLevel.MEDIUM,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '安全审计',
    affectedAssets: ['vpn.example.com'],
    description: 'VPN服务使用过时的加密算法（DES、3DES），可能被破解。',
    remediation: '1. 升级到强加密算法（AES-256）\n2. 禁用弱加密套件\n3. 更新VPN客户端\n4. 定期审查加密配置',
    discoveredAt: '2025-10-25 14:30:00',
    updatedAt: '2025-10-25 14:30:00',
    cvssScore: 5.9,
  },
  {
    id: 'risk-027',
    name: 'DNS服务器允许区域传送',
    level: RiskLevel.MEDIUM,
    type: RiskType.DATA_LEAK,
    status: RiskStatus.PENDING,
    source: '自动扫描 - DNSRecon',
    affectedAssets: ['ns1.example.com', 'ns2.example.com'],
    description: 'DNS服务器未限制区域传送，攻击者可获取完整的域名记录。',
    remediation: '1. 限制区域传送仅允许授权服务器\n2. 使用TSIG认证\n3. 实施访问控制列表\n4. 监控异常DNS查询',
    discoveredAt: '2025-10-26 10:20:00',
    updatedAt: '2025-10-26 10:20:00',
    cvssScore: 5.3,
  },
  {
    id: 'risk-028',
    name: 'Android应用未启用代码混淆',
    level: RiskLevel.LOW,
    type: RiskType.CONFIG_ERROR,
    status: RiskStatus.PENDING,
    source: '移动应用安全测试',
    affectedAssets: ['com.example.app v2.1.0'],
    description: 'Android应用未启用ProGuard代码混淆，容易被反编译和逆向分析。',
    remediation: '1. 启用ProGuard或R8混淆\n2. 配置混淆规则\n3. 使用字符串加密\n4. 实施根检测和防篡改',
    discoveredAt: '2025-10-25 15:45:00',
    updatedAt: '2025-10-25 15:45:00',
    cvssScore: 3.7,
  },
  {
    id: 'risk-029',
    name: 'Memcached未绑定内网地址',
    level: RiskLevel.HIGH,
    type: RiskType.UNAUTHORIZED_ACCESS,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Masscan',
    affectedAssets: ['192.168.1.190:11211'],
    description: 'Memcached绑定在0.0.0.0，且未启用SASL认证，可被用于DDoS放大攻击。',
    attackPath: ['公网访问', 'Memcached服务', 'DDoS放大', '缓存数据泄露'],
    remediation: '1. 绑定到127.0.0.1或内网IP\n2. 启用SASL认证\n3. 配置防火墙规则\n4. 升级到最新版本',
    discoveredAt: '2025-10-27 11:50:00',
    updatedAt: '2025-10-27 11:50:00',
    cvssScore: 8.6,
  },
  {
    id: 'risk-030',
    name: 'Grafana默认管理员密码未修改',
    level: RiskLevel.MEDIUM,
    type: RiskType.WEAK_PASSWORD,
    status: RiskStatus.PENDING,
    source: '自动扫描 - Metasploit',
    affectedAssets: ['https://grafana.example.com'],
    description: 'Grafana监控平台使用默认管理员密码（admin/admin），存在被入侵风险。',
    remediation: '1. 立即修改默认密码\n2. 启用双因素认证\n3. 配置LDAP或OAuth认证\n4. 限制管理员权限',
    discoveredAt: '2025-10-27 14:10:00',
    updatedAt: '2025-10-27 14:10:00',
    cvssScore: 6.5,
  },
]

/**
 * 合并所有风险数据
 */
export const allMockRisks: RiskItem[] = [...mockRisks, ...additionalRisks]

/**
 * 计算风险统计数据
 */
export function calculateRiskStats(risks: RiskItem[]): RiskStats {
  const stats: RiskStats = {
    total: risks.length,
    high: 0,
    medium: 0,
    low: 0,
    byType: {
      [RiskType.WEAK_PASSWORD]: 0,
      [RiskType.SQL_INJECTION]: 0,
      [RiskType.XSS]: 0,
      [RiskType.CONFIG_ERROR]: 0,
      [RiskType.OUTDATED_SOFTWARE]: 0,
      [RiskType.UNAUTHORIZED_ACCESS]: 0,
      [RiskType.DATA_LEAK]: 0,
      [RiskType.PRIVILEGE_ESCALATION]: 0,
    },
    trend: [],
  }

  // 统计各等级风险数量
  risks.forEach((risk) => {
    if (risk.level === RiskLevel.HIGH) {
      stats.high++
    }
    else if (risk.level === RiskLevel.MEDIUM) {
      stats.medium++
    }
    else {
      stats.low++
    }

    // 统计各类型风险数量
    stats.byType[risk.type]++
  })

  // 生成近7天趋势数据（模拟）
  const today = new Date()

  for (let i = 6; i >= 0; i--) {
    const date = new Date(today)
    date.setDate(date.getDate() - i)
    const dateStr = date.toISOString().split('T')[0]

    // 模拟每天的风险数量（随机生成）
    const dayTotal = Math.floor(Math.random() * 8) + 2
    const dayHigh = Math.floor(Math.random() * 3)
    const dayMedium = Math.floor(Math.random() * 4)
    const dayLow = dayTotal - dayHigh - dayMedium

    stats.trend.push({
      date: dateStr,
      count: dayTotal,
      high: dayHigh,
      medium: dayMedium,
      low: dayLow,
    })
  }

  return stats
}

/**
 * 导出默认统计数据
 */
export const mockRiskStats = calculateRiskStats(allMockRisks)
