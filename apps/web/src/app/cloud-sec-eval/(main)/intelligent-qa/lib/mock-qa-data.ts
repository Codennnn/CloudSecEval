import type { QAPair, SuggestedQuestion } from '../types'

/**
 * 推荐问题列表
 * 用于空状态展示和快速提问
 */
export const suggestedQuestions: SuggestedQuestion[] = [
  {
    id: 'q1',
    text: '《网络安全法》对数据出境有哪些要求？',
    category: '数据合规',
  },
  {
    id: 'q2',
    text: '等保 2.0 三级系统需要满足哪些技术要求？',
    category: '等级保护',
  },
  {
    id: 'q3',
    text: '个人信息保护法中关于敏感个人信息的定义是什么？',
    category: '个人信息保护',
  },
  {
    id: 'q4',
    text: '云服务商需要具备哪些安全资质？',
    category: '云安全',
  },
  {
    id: 'q5',
    text: 'GDPR 与中国个人信息保护法有哪些主要区别？',
    category: '法规对比',
  },
  {
    id: 'q6',
    text: '关键信息基础设施的认定标准是什么？',
    category: '关基保护',
  },
]

/**
 * 预设问答对
 * 用于模拟 AI 回复
 */
export const mockQAPairs: QAPair[] = [
  {
    question: '《网络安全法》对数据出境有哪些要求？',
    answer: `根据《中华人民共和国网络安全法》第三十七条规定，关键信息基础设施的运营者在中华人民共和国境内运营中收集和产生的个人信息和重要数据应当在境内存储。

**主要要求包括：**

1. **境内存储原则**
   - 个人信息和重要数据应当在境内存储
   - 因业务需要确需向境外提供的，应当按照规定进行安全评估

2. **安全评估要求**
   - 需要通过国家网信部门组织的安全评估
   - 评估内容包括数据出境的必要性、安全性等

3. **用户同意机制**
   - 向境外提供个人信息时，应当告知用户
   - 需要获得用户的明确同意

4. **合同约束**
   - 与境外接收方签订数据保护协议
   - 明确双方的安全保护责任和义务

**相关法规：**
- 《数据出境安全评估办法》
- 《个人信息保护法》第三十八条至第四十三条`,
    keywords: ['网络安全法', '数据出境', '境内存储', '安全评估'],
  },
  {
    question: '等保 2.0 三级系统需要满足哪些技术要求？',
    answer: `等保 2.0（GB/T 22239-2019）三级系统的技术要求主要包括以下几个方面：

**1. 安全物理环境**
- 物理位置选择、物理访问控制
- 防盗窃和防破坏、防雷击、防火、防水和防潮
- 温湿度控制、电力供应、电磁防护

**2. 安全通信网络**
- 网络架构、通信传输、可信验证
- 边界防护、入侵防范、恶意代码防范
- 网络设备防护、安全审计

**3. 安全区域边界**
- 边界防护、访问控制、入侵防范
- 恶意代码和垃圾邮件防范、安全审计
- 可信验证

**4. 安全计算环境**
- 身份鉴别、访问控制、安全审计
- 入侵防范、恶意代码防范
- 可信验证、数据完整性、数据保密性
- 数据备份恢复、剩余信息保护
- 个人信息保护

**5. 安全管理中心**
- 系统管理、审计管理、安全管理
- 集中管控

**关键控制点：**
- 双因素认证
- 数据加密传输和存储
- 完整的日志审计
- 定期安全评估和渗透测试`,
    keywords: ['等保', '等级保护', '三级系统', '技术要求', '等保2.0'],
  },
  {
    question: '个人信息保护法中关于敏感个人信息的定义是什么？',
    answer: `根据《中华人民共和国个人信息保护法》第二十八条，**敏感个人信息**是指一旦泄露或者非法使用，容易导致自然人的人格尊严受到侵害或者人身、财产安全受到危害的个人信息。

**敏感个人信息包括：**

1. **生物识别信息**
   - 指纹、面部识别特征、虹膜、声纹等

2. **宗教信仰**
   - 个人的宗教信仰情况

3. **特定身份信息**
   - 身份证件号码、护照号码等

4. **医疗健康信息**
   - 病历、体检报告、基因数据等

5. **金融账户信息**
   - 银行账号、信用卡信息、交易记录等

6. **行踪轨迹**
   - 精准定位信息、行动轨迹等

7. **未成年人信息**
   - 不满十四周岁未成年人的个人信息

**处理敏感个人信息的特殊要求：**
- 必须取得个人的单独同意
- 需要向个人告知处理的必要性以及对个人权益的影响
- 法律、行政法规规定处理敏感个人信息应当取得书面同意的，从其规定`,
    keywords: ['个人信息保护法', '敏感个人信息', '生物识别', '个人信息'],
  },
  {
    question: '云服务商需要具备哪些安全资质？',
    answer: `云服务商在中国开展业务通常需要具备以下安全资质和认证：

**1. 基础资质**
- **增值电信业务经营许可证（ICP/ISP）**
  - 提供云服务的基本资质要求

**2. 安全等级保护**
- **等保三级认证**
  - 云平台需通过等保三级测评
  - 定期进行复评（每年一次）

**3. 可信云认证**
- **可信云服务认证**
  - 由中国信通院颁发
  - 评估云服务的数据管理、业务质量、权益保障等

**4. ISO 国际标准认证**
- **ISO 27001** - 信息安全管理体系
- **ISO 27017** - 云服务信息安全控制
- **ISO 27018** - 云中个人信息保护
- **ISO 20000** - IT 服务管理体系
- **ISO 9001** - 质量管理体系

**5. 行业特定资质**
- **金融行业**：人民银行、银保监会相关认证
- **医疗行业**：医疗云服务相关资质
- **政务云**：政务云服务安全评估

**6. 其他重要认证**
- **CSA STAR 认证** - 云安全联盟认证
- **SOC 2 Type II** - 服务组织控制报告
- **PCI DSS** - 支付卡行业数据安全标准（如涉及支付）

**7. 数据安全相关**
- **数据安全管理认证（DSMS）**
- **个人信息保护认证**

建议选择云服务商时，重点关注等保三级、可信云、ISO 27001 等核心资质。`,
    keywords: ['云服务', '安全资质', '等保', 'ISO', '可信云'],
  },
  {
    question: 'GDPR 与中国个人信息保护法有哪些主要区别？',
    answer: `GDPR（欧盟通用数据保护条例）与中国《个人信息保护法》在多个方面存在差异：

**1. 适用范围**
- **GDPR**：域外效力强，只要处理欧盟居民数据就适用
- **中国法**：主要适用于在中国境内处理个人信息的活动

**2. 法律基础**
- **GDPR**：六大合法性基础（同意、合同、法定义务、生命利益、公共利益、合法利益）
- **中国法**：以"告知-同意"为核心，强调个人同意

**3. 数据跨境传输**
- **GDPR**：充分性认定、标准合同条款、约束性公司规则
- **中国法**：安全评估、标准合同、个人信息保护认证

**4. 处罚力度**
- **GDPR**：最高可达全球年营业额的 4% 或 2000 万欧元
- **中国法**：最高可达 5000 万元或上一年度营业额的 5%

**5. 个人权利**
- **GDPR**：
  - 访问权、更正权、删除权（被遗忘权）
  - 限制处理权、数据可携带权、反对权
- **中国法**：
  - 知情权、决定权、查阅复制权
  - 更正补充权、删除权、解释说明权

**6. 数据保护官（DPO）**
- **GDPR**：特定情况下强制要求设立 DPO
- **中国法**：要求指定个人信息保护负责人

**7. 儿童保护**
- **GDPR**：16 岁以下（成员国可降至 13 岁）
- **中国法**：14 岁以下

**8. 自动化决策**
- **GDPR**：明确规定个人有权不受自动化决策约束
- **中国法**：要求保证决策透明度和结果公平公正

**共同点：**
- 都强调数据主体权利保护
- 都要求数据处理透明度
- 都规定了严格的数据安全义务`,
    keywords: ['GDPR', '个人信息保护法', '法规对比', '数据保护'],
  },
  {
    question: '关键信息基础设施的认定标准是什么？',
    answer: `根据《关键信息基础设施安全保护条例》，关键信息基础设施的认定标准如下：

**一、基本定义**
关键信息基础设施是指公共通信和信息服务、能源、交通、水利、金融、公共服务、电子政务、国防科技工业等重要行业和领域的，以及其他一旦遭到破坏、丧失功能或者数据泄露，可能严重危害国家安全、国计民生、公共利益的重要网络设施、信息系统等。

**二、认定原则**

1. **行业领域原则**
   - 属于八大重要行业和领域
   - 公共通信和信息服务
   - 能源、交通、水利
   - 金融、公共服务
   - 电子政务、国防科技工业

2. **重要性原则**
   - 承载关键业务
   - 服务用户数量大
   - 对其他行业和领域有重大影响

3. **危害性原则**
   一旦遭到破坏、丧失功能或数据泄露，可能导致：
   - 危害国家安全
   - 损害国计民生
   - 影响公共利益

**三、认定流程**

1. **运营者申报**
   - 运营者对照认定规则进行初步判断
   - 向行业主管部门报送相关材料

2. **部门认定**
   - 保护工作部门组织认定
   - 会同网信部门进行评估

3. **结果通知**
   - 及时通知运营者认定结果
   - 建立关键信息基础设施名录

**四、认定要素**

1. **网络规模**
   - 网络和信息系统的规模
   - 覆盖范围和用户数量

2. **资产价值**
   - 承载数据的重要程度
   - 信息系统的资产价值

3. **业务重要性**
   - 对国家安全的影响
   - 对经济社会的影响
   - 对公共利益的影响

4. **关联性**
   - 与其他关键信息基础设施的关联程度
   - 对其他行业领域的影响程度

**五、保护要求**

被认定为关键信息基础设施后，运营者需要：
- 建立专门安全管理机构
- 定期开展网络安全检测和风险评估
- 制定网络安全事件应急预案
- 优先采购安全可信的网络产品和服务
- 数据境内存储
- 接受国家安全审查`,
    keywords: ['关键信息基础设施', '关基', '认定标准', '网络安全'],
  },
]

/**
 * 默认回复（当没有匹配到预设问答时）
 */
export const defaultAnswer = `感谢您的提问。这是一个关于法律法规的专业问题。

在实际的智能问答系统中，我会基于以下能力为您提供准确的答案：

**1. 知识库检索**
- 从法律法规文档库中检索相关条款
- 匹配最相关的法规内容

**2. 语义理解**
- 理解问题的核心意图
- 识别关键法律概念和术语

**3. 智能分析**
- 结合多个法规条款进行综合分析
- 提供结构化的解答

**4. 引用溯源**
- 标注答案来源的具体法规条款
- 提供原文链接供查阅

**建议：**
您可以尝试点击上方的推荐问题，查看更详细的示例回答。

如需了解特定法规内容，建议访问"知识库"模块查看完整的法律法规文档。`

/**
 * 根据问题内容匹配最佳答案
 */
export function findBestAnswer(question: string): string {
  const normalizedQuestion = question.toLowerCase().trim()

  // 尝试精确匹配
  const exactMatch = mockQAPairs.find((pair) => {
    return pair.question.toLowerCase() === normalizedQuestion
  })

  if (exactMatch) {
    return exactMatch.answer
  }

  // 尝试关键词匹配
  const keywordMatch = mockQAPairs.find((pair) => {
    if (!pair.keywords) {
      return false
    }

    return pair.keywords.some((keyword) => {
      return normalizedQuestion.includes(keyword.toLowerCase())
    })
  })

  if (keywordMatch) {
    return keywordMatch.answer
  }

  // 返回默认回复
  return defaultAnswer
}

