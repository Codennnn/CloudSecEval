# æ•°æ®åº“ç§å­è„šæœ¬ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

æ•°æ®åº“ç§å­è„šæœ¬ç”¨äºåˆå§‹åŒ–ç³»ç»Ÿå¿…è¦çš„åŸºç¡€æ•°æ®å’Œæµ‹è¯•æ•°æ®ã€‚ç»è¿‡é‡æ„çš„ç§å­è„šæœ¬ç³»ç»Ÿå…·æœ‰æ¸…æ™°çš„æ¨¡å—åŒ–æ¶æ„ã€ç»Ÿä¸€çš„æ¥å£å’Œçµæ´»çš„é…ç½®é€‰é¡¹ï¼Œæ”¯æŒä¸åŒç¯å¢ƒä¸‹çš„æ•°æ®ç”Ÿæˆéœ€æ±‚ã€‚

## ç›®å½•

- [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [å‘½ä»¤è¯¦è§£](#å‘½ä»¤è¯¦è§£)
- [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
- [ç¯å¢ƒå˜é‡é…ç½®](#ç¯å¢ƒå˜é‡é…ç½®)
- [æ¶æ„è¯´æ˜](#æ¶æ„è¯´æ˜)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ æ¨¡å—åŒ–è®¾è®¡

- **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç§å­è„šæœ¬è´Ÿè´£ç‰¹å®šé¢†åŸŸçš„æ•°æ®
- **ä¾èµ–ç®¡ç†**ï¼šè‡ªåŠ¨å¤„ç†æ•°æ®ç”Ÿæˆçš„ä¾èµ–é¡ºåº
- **é”™è¯¯éš”ç¦»**ï¼šå•ä¸ªæ¨¡å—å¤±è´¥ä¸å½±å“å…¶ä»–æ¨¡å—

### ğŸš€ æ™ºèƒ½æ‰§è¡Œ

- **ç¯å¢ƒæ„ŸçŸ¥**ï¼šæ ¹æ®ç¯å¢ƒè‡ªåŠ¨è°ƒæ•´æ•°æ®ç”Ÿæˆç­–ç•¥
- **å¢é‡æ›´æ–°**ï¼šé¿å…é‡å¤åˆ›å»ºå·²å­˜åœ¨çš„æ•°æ®
- **å®Œæ•´æ€§éªŒè¯**ï¼šè‡ªåŠ¨éªŒè¯ç”Ÿæˆæ•°æ®çš„å®Œæ•´æ€§

### ğŸ› ï¸ çµæ´»é…ç½®

- **å‘½ä»¤è¡Œæ¥å£**ï¼šä¸°å¯Œçš„å‘½ä»¤å’Œé€‰é¡¹æ”¯æŒ
- **ç¯å¢ƒå˜é‡**ï¼šæ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡è‡ªå®šä¹‰é…ç½®
- **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒæ‰¹é‡åˆ›å»ºå’Œæ¸…ç†æ“ä½œ

## å¿«é€Ÿå¼€å§‹

### åˆ›å»ºå®Œæ•´æ•°æ®é›†

```bash
# æ ¹æ®å½“å‰ç¯å¢ƒè‡ªåŠ¨ç”Ÿæˆå®Œæ•´æ•°æ®
pnpm db:seed

# æˆ–æ˜ç¡®æŒ‡å®šå®Œæ•´æ¨¡å¼
pnpm db:seed full
```

### ä»…åˆ›å»ºå¿…è¦æ•°æ®

```bash
# åˆ›å»ºç®¡ç†å‘˜è´¦å·
pnpm db:seed:admin

# åˆ›å»ºç»„ç»‡å’Œéƒ¨é—¨ç»“æ„
pnpm db:seed:org
```

### å¼€å‘ç¯å¢ƒå¿«é€Ÿè®¾ç½®

```bash
# å¿«é€Ÿç”Ÿæˆå¼€å‘ç¯å¢ƒæ•°æ®
pnpm db:quick

# ç”ŸæˆæŒ‡å®šæ•°é‡çš„æ•°æ®
pnpm db:seed user --count 50
```

### æŸ¥çœ‹æ•°æ®çŠ¶æ€

```bash
# æŸ¥çœ‹å½“å‰æ•°æ®ç»Ÿè®¡
pnpm db:seed:stats

# éªŒè¯æ•°æ®å®Œæ•´æ€§
pnpm db:seed:validate
```

## å‘½ä»¤è¯¦è§£

### åŸºç¡€å‘½ä»¤

| å‘½ä»¤                   | æè¿°                       | ç¤ºä¾‹                   |
| ---------------------- | -------------------------- | ---------------------- |
| `pnpm db:seed`         | æ‰§è¡Œå®Œæ•´çš„ç§å­è„šæœ¬ï¼ˆé»˜è®¤ï¼‰ | `pnpm db:seed`         |
| `pnpm db:seed:admin`   | ä»…åˆ›å»ºç®¡ç†å‘˜è´¦å·           | `pnpm db:seed:admin`   |
| `pnpm db:seed:org`     | ä»…åˆ›å»ºç»„ç»‡å’Œéƒ¨é—¨           | `pnpm db:seed:org`     |
| `pnpm db:seed:user`    | ä»…åˆ›å»ºç”¨æˆ·æ•°æ®             | `pnpm db:seed:user`    |
| `pnpm db:seed:license` | ä»…åˆ›å»ºæˆæƒç æ•°æ®           | `pnpm db:seed:license` |
| `pnpm db:seed:logs`    | ä»…åˆ›å»ºè®¿é—®æ—¥å¿—æ•°æ®         | `pnpm db:seed:logs`    |

### ç¯å¢ƒç‰¹å®šå‘½ä»¤

| å‘½ä»¤                | æè¿°             | ç¤ºä¾‹                |
| ------------------- | ---------------- | ------------------- |
| `pnpm db:seed:dev`  | å¼€å‘ç¯å¢ƒå®Œæ•´æ•°æ® | `pnpm db:seed:dev`  |
| `pnpm db:seed:test` | æµ‹è¯•ç¯å¢ƒæ•°æ®     | `pnpm db:seed:test` |
| `pnpm db:seed:prod` | ç”Ÿäº§ç¯å¢ƒæœ€å°æ•°æ® | `pnpm db:seed:prod` |

### ç®¡ç†å‘½ä»¤

| å‘½ä»¤                    | æè¿°                           | ç¤ºä¾‹                    |
| ----------------------- | ------------------------------ | ----------------------- |
| `pnpm db:seed:clean`    | æ¸…ç†æ‰€æœ‰æµ‹è¯•æ•°æ®ï¼ˆä¿ç•™ç®¡ç†å‘˜ï¼‰ | `pnpm db:seed:clean`    |
| `pnpm db:seed:stats`    | æ˜¾ç¤ºæ•°æ®ç»Ÿè®¡ä¿¡æ¯               | `pnpm db:seed:stats`    |
| `pnpm db:seed:validate` | éªŒè¯æ•°æ®å®Œæ•´æ€§                 | `pnpm db:seed:validate` |
| `pnpm db:quick`         | å¿«é€Ÿç”Ÿæˆå¼€å‘æ•°æ®               | `pnpm db:quick`         |

### é«˜çº§é€‰é¡¹

```bash
# è‡ªå®šä¹‰æ•°æ®æ•°é‡
pnpm db:seed user --count 100

# å¼ºåˆ¶æ‰§è¡Œï¼ˆå¿½ç•¥å·²å­˜åœ¨æ•°æ®ï¼‰
pnpm db:seed --force

# ä¸åˆ›å»ºé¢„è®¾æ•°æ®
pnpm db:seed --no-presets

# ç”ŸæˆçœŸå®è®¿é—®æ¨¡å¼
pnpm db:seed full --realistic

# æ¸…ç†åŒ…æ‹¬ç®¡ç†å‘˜åœ¨å†…çš„æ‰€æœ‰æ•°æ®
pnpm db:seed clean --no-preserve-admin

# é™é»˜æ‰§è¡Œ
pnpm db:seed --silent

# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
pnpm db:seed --help
```

## ä½¿ç”¨åœºæ™¯

### ğŸ—ï¸ é¡¹ç›®åˆå§‹åŒ–

```bash
# é¦–æ¬¡éƒ¨ç½²ç³»ç»Ÿ
pnpm db:init
pnpm db:seed:prod  # ç”Ÿäº§ç¯å¢ƒ
# æˆ–
pnpm db:seed:dev   # å¼€å‘ç¯å¢ƒ
```

### ğŸ§ª å¼€å‘è°ƒè¯•

```bash
# æ¸…ç†å¹¶é‡æ–°ç”Ÿæˆå¼€å‘æ•°æ®
pnpm db:seed:clean
pnpm db:quick

# æ·»åŠ æ›´å¤šæµ‹è¯•ç”¨æˆ·
pnpm db:seed user --count 20

# ç”ŸæˆçœŸå®è®¿é—®æ¨¡å¼è¿›è¡Œæµ‹è¯•
pnpm db:seed logs --realistic
```

### ğŸ” æµ‹è¯•å‡†å¤‡

```bash
# å‡†å¤‡æµ‹è¯•ç¯å¢ƒ
pnpm db:seed:test

# éªŒè¯æµ‹è¯•æ•°æ®
pnpm db:seed:validate
```

### ğŸ“Š æ•°æ®åˆ†æ

```bash
# æŸ¥çœ‹å½“å‰æ•°æ®åˆ†å¸ƒ
pnpm db:seed:stats

# ç”Ÿæˆå¤§é‡æ•°æ®è¿›è¡Œæ€§èƒ½æµ‹è¯•
pnpm db:seed full --count 1000
```

## ç¯å¢ƒå˜é‡é…ç½®

### ç®¡ç†å‘˜è´¦å·é…ç½®

| ç¯å¢ƒå˜é‡         | è¯´æ˜           | é»˜è®¤å€¼              |
| ---------------- | -------------- | ------------------- |
| `ADMIN_EMAIL`    | ç®¡ç†å‘˜é‚®ç®±     | `admin@example.com` |
| `ADMIN_PASSWORD` | ç®¡ç†å‘˜å¯†ç      | `Admin@123`         |
| `ADMIN_NAME`     | ç®¡ç†å‘˜æ˜¾ç¤ºåç§° | `ç³»ç»Ÿç®¡ç†å‘˜`        |

### æ‰§è¡Œè¡Œä¸ºé…ç½®

| ç¯å¢ƒå˜é‡       | è¯´æ˜         | é»˜è®¤å€¼        |
| -------------- | ------------ | ------------- |
| `NODE_ENV`     | è¿è¡Œç¯å¢ƒ     | `development` |
| `AUTO_CONFIRM` | è‡ªåŠ¨ç¡®è®¤æ“ä½œ | `false`       |

### é…ç½®ç¤ºä¾‹

```bash
# .env æ–‡ä»¶é…ç½®
ADMIN_EMAIL=admin@yourcompany.com
ADMIN_PASSWORD=SecurePassword123
ADMIN_NAME=æŠ€æœ¯æ€»ç›‘
NODE_ENV=development
AUTO_CONFIRM=true

# ä½¿ç”¨è‡ªå®šä¹‰é…ç½®è¿è¡Œ
pnpm db:seed
```

## æ¶æ„è¯´æ˜

### ç›®å½•ç»“æ„

```
src/prisma/seeds/
â”œâ”€â”€ core/                    # æ ¸å¿ƒæŠ½è±¡å’Œç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ base-factory.ts      # æ•°æ®å·¥å‚åŸºç±»
â”‚   â”œâ”€â”€ base-seeder.ts       # ç§å­è„šæœ¬åŸºç±»
â”‚   â””â”€â”€ types.ts             # ç±»å‹å®šä¹‰
â”œâ”€â”€ factories/               # æ•°æ®å·¥å‚ï¼ˆæ•°æ®ç”Ÿæˆé€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ access-log.factory.ts
â”‚   â”œâ”€â”€ department.factory.ts
â”‚   â”œâ”€â”€ license.factory.ts
â”‚   â”œâ”€â”€ organization.factory.ts
â”‚   â””â”€â”€ user.factory.ts
â”œâ”€â”€ seeders/                 # ç§å­è„šæœ¬ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ admin.seeder.ts
â”‚   â”œâ”€â”€ organization.seeder.ts
â”‚   â”œâ”€â”€ user.seeder.ts
â”‚   â”œâ”€â”€ license.seeder.ts
â”‚   â””â”€â”€ access-log.seeder.ts
â”œâ”€â”€ utils/                   # å·¥å…·ç±»
â”‚   â””â”€â”€ cli.util.ts
â”œâ”€â”€ main.ts                  # ä¸»å…¥å£è„šæœ¬
â””â”€â”€ orchestrator.ts          # æ‰§è¡Œç¼–æ’å™¨
```

### æ ¸å¿ƒç»„ä»¶

#### BaseSeeder

- æä¾›ç»Ÿä¸€çš„ç§å­è„šæœ¬æ¥å£
- æ ‡å‡†åŒ–çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- è‡ªåŠ¨çš„å‰ç½®/åç½®éªŒè¯

#### SeedOrchestrator

- ç®¡ç†ç§å­è„šæœ¬çš„æ‰§è¡Œé¡ºåº
- å¤„ç†è„šæœ¬é—´çš„ä¾èµ–å…³ç³»
- æä¾›æ‰¹é‡æ“ä½œå’Œç»Ÿè®¡åŠŸèƒ½

#### Factory Classes

- è´Ÿè´£å…·ä½“çš„æ•°æ®ç”Ÿæˆé€»è¾‘
- æ”¯æŒæ‰¹é‡åˆ›å»ºå’Œé”™è¯¯é‡è¯•
- æä¾›æ•°æ®å®Œæ•´æ€§éªŒè¯

### ä¾èµ–å…³ç³»

```mermaid
graph TD
    A[AdminSeeder] --> B[OrganizationSeeder]
    B --> C[UserSeeder]
    C --> D[LicenseSeeder]
    D --> E[AccessLogSeeder]
```

## æœ€ä½³å®è·µ

### ğŸ¯ ç¯å¢ƒç­–ç•¥

**ç”Ÿäº§ç¯å¢ƒ**

- ä»…åˆ›å»ºå¿…è¦çš„åŸºç¡€æ•°æ®
- ä½¿ç”¨ `pnpm db:seed:prod`
- é¿å…åˆ›å»ºå¤§é‡æµ‹è¯•æ•°æ®

**å¼€å‘ç¯å¢ƒ**

- åˆ›å»ºä¸°å¯Œçš„æµ‹è¯•æ•°æ®
- ä½¿ç”¨ `pnpm db:seed:dev` æˆ– `pnpm db:quick`
- å®šæœŸæ¸…ç†å’Œé‡æ–°ç”Ÿæˆæ•°æ®

**æµ‹è¯•ç¯å¢ƒ**

- åˆ›å»ºæ ‡å‡†åŒ–çš„æµ‹è¯•æ•°æ®é›†
- ä½¿ç”¨ `pnpm db:seed:test`
- ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯é‡å¤æ€§

### ğŸ”„ æ—¥å¸¸å¼€å‘æµç¨‹

```bash
# 1. åˆå§‹åŒ–å¼€å‘ç¯å¢ƒ
pnpm dev:db
pnpm db:seed:dev

# 2. æ—¥å¸¸å¼€å‘ä¸­æ·»åŠ æµ‹è¯•æ•°æ®
pnpm db:seed user --count 10

# 3. éœ€è¦é‡æ–°å¼€å§‹æ—¶
pnpm db:seed:clean
pnpm db:quick

# 4. æ£€æŸ¥æ•°æ®çŠ¶æ€
pnpm db:seed:stats
```

### ğŸ“‹ æ•°æ®ç®¡ç†

- **å®šæœŸå¤‡ä»½**ï¼šé‡è¦æ•°æ®ç”Ÿæˆå‰å¤‡ä»½ç°æœ‰æ•°æ®
- **ç‰ˆæœ¬æ§åˆ¶**ï¼šç§å­è„šæœ¬å˜æ›´è¦è¿›è¡Œç‰ˆæœ¬æ§åˆ¶
- **æ–‡æ¡£æ›´æ–°**ï¼šæ–°å¢ç§å­è„šæœ¬è¦æ›´æ–°ä½¿ç”¨æ–‡æ¡£
- **æµ‹è¯•éªŒè¯**ï¼šç§å­è„šæœ¬ä¿®æ”¹åè¦è¿›è¡Œå……åˆ†æµ‹è¯•

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: ç§å­è„šæœ¬æ‰§è¡Œå¤±è´¥ï¼Œæ˜¾ç¤º"æ•°æ®åº“è¿æ¥å¤±è´¥"**

A: æ£€æŸ¥æ•°æ®åº“æœåŠ¡çŠ¶æ€å’Œè¿æ¥é…ç½®ï¼š

```bash
# æ£€æŸ¥æ•°æ®åº“æœåŠ¡
pnpm db:dev:up

# éªŒè¯è¿æ¥
pnpm prisma db push
```

**Q: ç®¡ç†å‘˜è´¦å·åˆ›å»ºå¤±è´¥**

A: æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®å’Œæ•°æ®åº“çº¦æŸï¼š

```bash
# æŸ¥çœ‹å½“å‰é…ç½®
echo $ADMIN_EMAIL
echo $ADMIN_NAME

# æ¸…ç†åé‡æ–°åˆ›å»º
pnpm db:seed:clean --no-preserve-admin
pnpm db:seed:admin
```

**Q: æ•°æ®éªŒè¯å¤±è´¥**

A: è¿è¡Œå®Œæ•´æ€§æ£€æŸ¥å’Œæ•°æ®ç»Ÿè®¡ï¼š

```bash
# æ£€æŸ¥æ•°æ®çŠ¶æ€
pnpm db:seed:stats
pnpm db:seed:validate

# é‡æ–°ç”Ÿæˆæœ‰é—®é¢˜çš„æ•°æ®
pnpm db:seed [specific-seeder] --force
```

**Q: ç§å­è„šæœ¬æ‰§è¡Œå¾ˆæ…¢**

A: ä¼˜åŒ–æ‰§è¡Œç­–ç•¥ï¼š

```bash
# ä½¿ç”¨å¿«é€Ÿæ¨¡å¼
pnpm db:quick

# å‡å°‘æ•°æ®é‡
pnpm db:seed user --count 10

# è·³è¿‡é¢„è®¾æ•°æ®
pnpm db:seed --no-presets
```

### è°ƒè¯•æŠ€å·§

**å¯ç”¨è¯¦ç»†æ—¥å¿—**

```bash
# æŸ¥çœ‹è¯¦ç»†æ‰§è¡Œè¿‡ç¨‹
DEBUG=* pnpm db:seed

# ä¸ä½¿ç”¨é™é»˜æ¨¡å¼
pnpm db:seed --no-silent
```

**åˆ†æ­¥æ‰§è¡Œ**

```bash
# é€ä¸ªæ‰§è¡Œç§å­è„šæœ¬
pnpm db:seed:admin
pnpm db:seed:org
pnpm db:seed:user
```

**æ•°æ®æ£€æŸ¥**

```bash
# æŸ¥çœ‹æ•°æ®åº“å†…å®¹
pnpm prisma:studio

# æ£€æŸ¥ç‰¹å®šè¡¨
pnpm db:seed:stats
```
